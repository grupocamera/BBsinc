<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title></title>

  <!-- Fallback absoluto se JS falhar: após 2s vai para o EXTERNO -->
  <meta http-equiv="refresh" content="2; url=http://187.49.156.114:5004/dashboard_geral">

  <script>
    // ================== CONFIGURE AQUI ==================
    const URL_INTERNO = "http://192.168.0.44:5004/gestao_de_graos";
    const URL_EXTERNO = "http://187.49.156.114:5004/dashboard_geral"; // troque se quiser
    const TIMEOUT_MS  = 900; // 700–900ms costuma ser ideal
    // ====================================================

    function timeout(ms) {
      return new Promise((_, reject) => setTimeout(() => reject(new Error("timeout")), ms));
    }

    function navegar(url) {
      // replace para não deixar histórico do redirecionador
      window.location.replace(url);
    }

    async function tentarAcesso() {
      // Guarda: se nada acontecer em 1500ms, força EXTERNO
      const guarda = setTimeout(() => navegar(URL_EXTERNO), 1500);

      try {
        // MUITO IMPORTANTE:
        // Em páginas HTTPS (GitHub Pages), um fetch para HTTP pode ser bloqueado (mixed content).
        // Se for bloqueado, o fetch vai lançar erro -> cai no catch -> navegamos para EXTERNO.
        await Promise.race([
          fetch(URL_INTERNO, { method: "HEAD", mode: "no-cors", cache: "no-store" }),
          timeout(TIMEOUT_MS)
        ]);

        // Se chegamos aqui sem timeout, consideramos a rota interna "atingível".
        clearTimeout(guarda);
        navegar(URL_INTERNO);

      } catch (e) {
        // Se deu erro (ex.: mixed content bloqueado, CORS, rede, etc.), vamos para EXTERNO
        clearTimeout(guarda);
        navegar(URL_EXTERNO);
      }
    }

    // Dispara o teste assim que possível (sem mostrar nada na tela)
    window.addEventListener("load", tentarAcesso);
  </script>

  <style>
    /* Tela completamente em branco (sem textos/loader) */
    html, body { background: #ffffff; margin: 0; padding: 0; height: 100%; }
  </style>
</head>
<body></body>
</html>
